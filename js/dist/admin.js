(()=>{var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e);const o=flarum.core.compat["admin/app"];var n=t.n(o);function r(t,e){return r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,e)}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e)}const i=flarum.core.compat["admin/components/ExtensionPage"];var l=t.n(i);const s=flarum.core.compat["common/components/LinkButton"];var u=t.n(s),p=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var o=e.prototype;return o.oninit=function(e){t.prototype.oninit.call(this,e)},o.content=function(){return[m("div",{className:"container"},m("div",{className:"AppleOAuthSettingsPage"},m("br",null),m(u(),{className:"Button",href:n().route("extension",{id:"fof-oauth"})},n().translator.trans("fof-oauth.admin.configure_button_label"))))]},e}(l());const c=flarum.core.compat["common/extend"],d=flarum.extensions["fof-oauth"];function f(){return f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},f.apply(this,arguments)}const h=flarum.core.compat["common/components/Button"];var y=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).loading=!1,e}a(e,t);var o=e.prototype;return o.view=function(e){this.attrs.loading=this.loading,this.attrs.className=(this.attrs.className||"")+" Button";var o=n().data.settings["fof-oauth.apple.key_file_path"];return o?(this.attrs.onclick=this.remove.bind(this),m("div",null,m("p",null,m("code",null,o)),m("p",null,t.prototype.view.call(this,f({},e,{children:n().translator.trans("fof-oauth.admin.settings.providers.apple.keyfile_upload.remove_button")}))))):(this.attrs.onclick=this.upload.bind(this),t.prototype.view.call(this,f({},e,{children:n().translator.trans("fof-oauth.admin.settings.providers.apple.keyfile_upload.upload_button")})))},o.upload=function(){var t=this;this.loading||$('<input type="file">').appendTo("body").hide().click().on("change",(function(e){var o=new FormData;o.append(t.attrs.name,$(e.target)[0].files[0]),t.loading=!0,m.redraw(),n().request({method:"POST",url:t.resourceUrl(),serialize:function(t){return t},body:o}).then(t.success.bind(t),t.failure.bind(t))}))},o.remove=function(){this.loading=!0,m.redraw(),n().request({method:"DELETE",url:this.resourceUrl()}).then(this.success.bind(this),this.failure.bind(this))},o.resourceUrl=function(){return n().forum.attribute("apiUrl")+"/oauth/apple/keyfile"},o.success=function(t){window.location.reload()},o.failure=function(t){this.loading=!1,m.redraw()},e}(t.n(h)());n().initializers.add("blomstra/oauth-apple",(function(){n().extensionData.for("blomstra-oauth-apple").registerPage(p),(0,c.extend)(d.AuthSettingsPage.prototype,"customProviderSettings",(function(t,e){"apple"===e&&t.add("apple-keyfile-upload",m("div",{className:"Form-group"},m("fieldset",null,m("legend",null,n().translator.trans("fof-oauth.admin.settings.providers.apple.keyfile_upload_label")),m("div",{className:"helpText"},n().translator.trans("fof-oauth.admin.settings.providers.apple.keyfile_upload_help",{a:m("a",{href:"https://developer.apple.com/account/resources/authkeys/list",target:"_blank"})})),m(y,{name:"apple-keyfile"}))),100)}))}))})(),module.exports=e})();
//# sourceMappingURL=admin.js.map