(()=>{var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e);const o=flarum.core.compat["admin/app"];var r=t.n(o);const a=flarum.extensions["fof-oauth"],n=flarum.core.compat["common/extend"];function i(){return i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])}return t},i.apply(this,arguments)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}const s=flarum.core.compat["common/components/Button"];var u=function(t){var e,o;function a(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).loading=!1,e}o=t,(e=a).prototype=Object.create(o.prototype),e.prototype.constructor=e,l(e,o);var n=a.prototype;return n.view=function(e){this.attrs.loading=this.loading,this.attrs.className=(this.attrs.className||"")+" Button";var o=r().data.settings["fof-oauth.apple.key_file_path"];return o?(this.attrs.onclick=this.remove.bind(this),m("div",null,m("p",null,m("code",null,o)),m("p",null,t.prototype.view.call(this,i({},e,{children:r().translator.trans("fof-oauth.admin.settings.providers.apple.keyfile_upload.remove_button")}))))):(this.attrs.onclick=this.upload.bind(this),t.prototype.view.call(this,i({},e,{children:r().translator.trans("fof-oauth.admin.settings.providers.apple.keyfile_upload.upload_button")})))},n.upload=function(){var t=this;this.loading||$('<input type="file">').appendTo("body").hide().click().on("change",(function(e){var o=new FormData;o.append(t.attrs.name,$(e.target)[0].files[0]),t.loading=!0,m.redraw(),r().request({method:"POST",url:t.resourceUrl(),serialize:function(t){return t},body:o}).then(t.success.bind(t),t.failure.bind(t))}))},n.remove=function(){this.loading=!0,m.redraw(),r().request({method:"DELETE",url:this.resourceUrl()}).then(this.success.bind(this),this.failure.bind(this))},n.resourceUrl=function(){return r().forum.attribute("apiUrl")+"/oauth/apple/keyfile"},n.success=function(t){window.location.reload()},n.failure=function(t){this.loading=!1,m.redraw()},a}(t.n(s)());r().initializers.add("blomstra/oauth-apple",(function(){r().extensionData.for("blomstra-oauth-apple").registerPage(a.ConfigureWithOAuthPage),(0,n.extend)(a.AuthSettingsPage.prototype,"customProviderSettings",(function(t,e){"apple"===e&&t.add("apple-keyfile-upload",m("div",{className:"Form-group"},m("fieldset",null,m("legend",null,r().translator.trans("fof-oauth.admin.settings.providers.apple.keyfile_upload_label")),m("div",{className:"helpText"},r().translator.trans("fof-oauth.admin.settings.providers.apple.keyfile_upload_help",{a:m("a",{href:"https://developer.apple.com/account/resources/authkeys/list",target:"_blank"})})),m(u,{name:"apple-keyfile"}))),100)}))}))})(),module.exports=e})();
//# sourceMappingURL=admin.js.map